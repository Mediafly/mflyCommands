(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.mflyCommands=e()}})(function(){var e,t,n;return function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var u=typeof require=="function"&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}var i=typeof require=="function"&&require;for(var s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(){return r.get("account")}n.getUserInfo=o;function i(){window.location.href="/interactive-redirect/v5/account/logout"}n.logout=i},{"./internalMethods":16}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e,t,n,o){return r.showUI("app-settings",e,t,n,o)}n.showSettings=o;function i(e,t,n,o){return r.showUI("user-management",e,t,n,o)}n.showUserManagement=i;function s(){return r.post("control/show-ui",{ui:"second-screen"})}n.showSecondScreenOptions=s;function a(e){return r.post("control/email",{id:e})}n.email=a;function u(e){return r.post("control/compose-email",e)}n.composeEmail=u;function c(){return r.post("control/show-ui",{ui:"annotations"})}n.showAnnotations=c;function l(){return r.post("control/email-screenshot")}n.takeAndEmailScreenshot=l},{"./internalMethods":16}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(){return r.post("sync")}n.refresh=o;function i(){return r.get("sync","status")}n.getSyncStatus=i},{"./internalMethods":16}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(){return r.get("collections")}n.getCollections=o;function i(e){return r.get("collections/"+e,"items")}n.getCollection=i;function s(e){return r.post("collections",{name:e})}n.createCollection=s;function a(e,t){return r.post("collections/"+e+"/items",{ids:[t]})}n.addItemToCollection=a;function u(e,t){return r.ddelete("collections/"+e+"/items/"+t)}n.removeItemFromCollection=u;function c(e,t){if(t===void 0){t=false}return r.ddelete("collections/"+e+"?shared="+t)}n.deleteCollection=c;function l(e,t,n){return r.put("collections/"+e+"/items/"+t+"/order?position="+n)}n.reorderItemInCollection=l;function d(e,t){return r.put("collections/"+e,{name:t})}n.renameCollection=d;function f(e,t,n,o){return r.showUI("collections",e,t,n,o)}n.showCollections=f;function m(e,t,n,o){return r.showUI("add-to-collection",e,t,n,o)}n.showAddToCollection=m},{"./internalMethods":16}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./device");function o(e){if(!r.isWeb()){return false}var t=["/control/","/downloads","/online-status","/system/gps"];return t.some(function(t){return e.indexOf(t)>-1})}n.isUnsupported=o},{"./device":8}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(){return r.post("control/show-ui",{ui:"control-bar",visible:true})}n.showControlBars=o;function i(e,t,n,o){return r.post("control/show-ui",{ui:"control-bar",visible:false})}n.hideControlBars=i},{"./internalMethods":16}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(){return r.get("credentials")}n.default=o},{"./internalMethods":16}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r="http://localhost:8000/";var o="/interactive-api/v5/";n.deviceTypes={development:"development",mobile:"mobile",web:"web",desktop:"desktop"};function i(){var e=navigator.userAgent.toLowerCase();if(e.indexOf("msie")!==-1){if(e.indexOf("webview")!==-1){return true}}return false}n.isWindows8=i;function s(){return window.location.host.indexOf("localhost:8000")>-1}n.isLocalhostForDevelopment=s;function a(){if(s()){return n.deviceTypes.development}else{var e=document.cookie.split(";").filter(function(e){return e.split("=")[0].toLowerCase().trim()==="devicetype"});if(e.length>0){return e[0].split("=")[1]}else{return n.deviceTypes.mobile}}}n.getDeviceType=a;n.isWeb=function(){return a()===n.deviceTypes.web};n.isDesktop=function(){return a()===n.deviceTypes.desktop};function u(){var e=a();switch(e){case n.deviceTypes.development:return r;default:return o}}n.getPrefix=u},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e,t,n,o){return r.showUI("downloads",e,t,n,o)}n.showDownloader=o;function i(e){return e?r.get("downloads/"+e+"/status"):r.get("downloads/status")}n.getDownloadStatus=i;function s(e){return r.post("downloads",{ids:[e]})}n.addToDownloader=s;function a(e){return r.ddelete("downloads/"+e)}n.removeFromDownloader=a},{"./internalMethods":16}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e){return r.post("email",e)}n.sendEmail=o;function i(e){return r.get("email-status",e)}n.getEmailStatus=i},{"./internalMethods":16}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./device");var o=e("./item");function i(e,t,n){o.getItem(t).then(function(t){var o=n?"?page="+n:"";if(r.isWeb()){e.attr("src",t.resourceUrl+o)}else{a(t.resourceUrl+o).then(function(){return e.attr("src",t.resourceUrl+o)})}})}n.embed=i;function s(e,t,n){var i=[];if(typeof n!="undefined"){i=[{name:"position",value:n.page},{name:"size",value:n.size},{name:"width",value:n.width},{name:"height",value:n.height},{name:"maxWidth",value:n.maxWidth},{name:"maxHeight",value:n.maxHeight},{name:"rotate",value:n.rotate}].filter(function(e){return!!e.value})}o.getItem(t).then(function(t){var n=t.resourceUrl;if(i.length>0){n+="?"+$.param(i)}if(r.isWeb()){e.attr("src",n)}else{a(n).then(function(){return e.attr("src",n)})}})}n.embedImage=s;function a(e){return $.get(e).then(function(t,n,r){if(r.status===202||r.status==200&&!r.responseText){var o=parseInt(r.getResponseHeader("Retry-After"))||3;var i=$.Deferred();setTimeout(function(){a(e).then(function(e){return i.resolve(e)})},o*1e3);return i.promise()}else{return t}})}function u(e){return o.getItem(e).then(function(e){return a(e.resourceUrl)})}n.getData=u},{"./device":8,"./item":17}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e){var t="";for(var n in e){if(e.hasOwnProperty(n)){t+=n+":"+e[n]+","}}t.slice(0,t.length-1);return t}function i(e){var t=$.Deferred();var n=[];var i=0;var s=100;var a=function(){var u=encodeURIComponent(o(e));return r.get("items?filter="+u+"&offset="+i+"&limit="+s).done(function(e){n=n.concat(e);if(e.length<s){t.resolve(n)}else{i+=s;a()}}).fail(function(){t.reject()})};a();return t.promise()}n.default=i},{"./internalMethods":16}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e){return r.get("items",e+"/items")}n.default=o},{"./internalMethods":16}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(){return r.get("system","gps")}n.default=o},{"./internalMethods":16}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(){return r.get("interactive")}n.default=o},{"./internalMethods":16}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./device");var o=e("./commandSupport");function i(){return typeof InteractivesInterface!=="undefined"}function s(e,t,n){if(t===void 0){t=null}if(n===void 0){n=true}var i=r.getPrefix();var s=i+e+(t===null?"":"/"+t);if(o.isUnsupported(s)){throw new Error("This method is not supported on this platform.")}var a=$.Deferred();$.ajax({url:s,success:function(e,t,r){if(n&&r&&r.getResponseHeader("Content-Type").indexOf("text/html")>-1){e=JSON.parse(e)}a.resolveWith(this,[e,r.status])},error:function(e,t,n){if(r.isWeb()&&e.status===401){sessionStorage.setItem("returnUrl",window.location.href);window.location.replace(e.responseJSON.returnUrl)}a.reject(this,[n,e.status])}});return a.promise()}n.get=s;function a(e,t){var n=$.Deferred();var s=r.getPrefix();var a=s+e;if(o.isUnsupported(a)){throw new Error("This method is not supported on this platform.")}if(i()){var u=InteractivesInterface.post(a,JSON.stringify(t));var c=JSON.parse(u);if(c.status===200){n.resolveWith(this,[c.data,c.status])}else{n.rejectWith(this,[c.data,c.status])}}else{$.ajax({method:"POST",url:a,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(e,t,r){n.resolveWith(this,[e,r.status])},error:function(e,t,o){if(r.isWeb()&&e.status===401){sessionStorage.setItem("returnUrl",window.location.href);window.location.replace(e.responseJSON.returnUrl)}n.reject(this,[o,e.status])}})}return n.promise()}n.post=a;function u(e,t){var n=$.Deferred();var s=r.getPrefix();var a=s+e;if(o.isUnsupported(a)){throw new Error("This method is not supported on this platform.")}if(i()){var u=InteractivesInterface.delete(a,JSON.stringify(t));var c=JSON.parse(u);n.resolveWith(this,[c.data,c.status])}else{$.ajax({method:"DELETE",url:a,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(e,t,r){n.resolveWith(this,[e,r.status])},error:function(e,t,o){if(r.isWeb()&&e.status===401){sessionStorage.setItem("returnUrl",window.location.href);window.location.replace(e.responseJSON.returnUrl)}n.reject(this,[o,e.status])}})}return n.promise()}n.ddelete=u;function c(e,t){if(t===void 0){t=null}var n=$.Deferred();var s=r.getPrefix();var a=s+e;if(o.isUnsupported(a)){throw new Error("This method is not supported on this platform.")}if(i()){var u=InteractivesInterface.put(a,JSON.stringify(t));var c=JSON.parse(u);n.resolveWith(this,[c.data,c.status])}else{$.ajax({method:"PUT",data:t,url:a,success:function(e,t,r){n.resolveWith(this,[e,r.status])},error:function(e,t,o){if(r.isWeb()&&e.status===401){sessionStorage.setItem("returnUrl",window.location.href);window.location.replace(e.responseJSON.returnUrl)}n.reject(this,[o,e.status])}})}return n.promise()}n.put=c;function l(e,t,n,r,o){return a("control/show-ui",{ui:e,position:{x:t,y:n,width:r,height:o}})}n.showUI=l},{"./commandSupport":5,"./device":8}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e){return r.get("items",e)}n.getItem=o;function i(){return o("__self__")}n.getCurrentItem=i;function s(e){return r.get("items",e+"/share")}n.getShare=s;function a(){return r.get("items","?list=last-viewed")}n.getLastViewedContent=a;function u(){return r.get("items","?list=recently-created")}n.getRecentlyCreatedContent=u},{"./internalMethods":16}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");var o=e("./device");var i=o.isWeb()||o.isDesktop();function s(e){if(i){return $.Deferred(function(t){var n={};for(var r in localStorage){if(r.slice(0,e.length)==e){n[r]=localStorage.getItem(r)}}t.resolveWith(this,[n,200])})}else{return r.get("info?prefix="+e)}}function a(){if(i){var e={};for(var t in localStorage){e[t]=localStorage.getItem(t)}return $.when(e)}else{return r.get("info")}}function u(e){if(e){return s(e)}else{return a()}}n.getValues=u;function c(e){if(!e){return $.Deferred().rejectWith(this,["Invalid key provided",500])}if(i){return $.Deferred(function(t){var n=localStorage.getItem(e);if(n){t.resolveWith(this,[n,200])}else{t.rejectWith(this,[n,404])}})}else{return r.get("info",e,false)}}n.getValue=c;function l(e,t){if(!e){return $.Deferred().rejectWith(this,["Invalid key provided",500])}if(i){return $.Deferred(function(n){localStorage.setItem(e,t);n.resolveWith(this,["",200])})}else{return r.post("info",[{key:e,value:t}])}}n.putValue=l;function d(e){if(!e){return $.Deferred().rejectWith(this,["Invalid key provided",500])}if(i){return $.Deferred(function(t){localStorage.removeItem(e);t.resolveWith(this,["",200])})}else{return r.ddelete("info/"+e)}}n.deleteKey=d},{"./device":8,"./internalMethods":16}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./item");var o=e("./device");function i(){window.location.href="/interactive-redirect/v5/items/__self__/back"}n.close=i;function s(){window.location.href="/interactive-redirect/v5/items/__self__/next"}n.next=s;function a(){window.location.href="/interactive-redirect/v5/items/__self__/previous"}n.previous=a;function u(e,t){r.getItem(e).then(function(e){var n={};var r=e.url;if(o.isWeb()||o.isDesktop()){n["returnurl"]=window.location.href}if(t){n["bookmark"]=t}r+=(r.indexOf("?")>-1?"&":"?")+$.param(n);window.location.href=window.location.protocol+"//"+window.location.host+r})}n.openItem=u;n.open=u;function c(e){r.getItem(e).then(function(e){window.location.href=e.url})}n.openFolder=c;function l(){console.error("goto method is now deprecated. Please use openItem going forward.")}n.goto=l;function d(){console.error("browse method is now deprecated. Please use openItem going forward.")}n.browse=d},{"./device":8,"./item":17}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e){return r.post("notifications/"+e)}n.addNotification=o;function i(e){return r.ddelete("notifications/"+e)}n.removeNotification=i;function s(e){return r.get("notifications/"+e)}n.getNotificationStatus=s;function a(e,t,n,o){return r.showUI("notifications",e,t,n,o)}n.showNotificationManager=a},{"./internalMethods":16}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e){return r.get("system","online-status")}n.default=o},{"./internalMethods":16}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./utils");function o(e){return window.open(e,"InteractivesWindow"+r.guid())}n.default=o},{"./utils":29}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e){return r.post("actions",e)}n.postAction=o;function i(e,t){return r.post("actions",{type:"document",id:e,page:t})}n.postPageView=i},{"./internalMethods":16}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e,t){return r.post("events",{key:e,properties:JSON.stringify(t)})}n.postEvent=o},{"./internalMethods":16}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e,t,n){if(t===void 0){t=0}if(n===void 0){n=100}var o=$.Deferred();var i=[];var s={term:e,offset:t,limit:n};var a=function(){var e=$.param(s);r.get("items?"+e).done(function(e){i=i.concat(e);if(e.length<s.limit){o.resolve(i)}else{s.offset+=s.limit;a()}}).fail(function(){o.reject()})};a();return o.promise()}n.search=o;function i(e,t,n,o){return r.showUI("search",e,t,n,o)}n.showSearch=i},{"./internalMethods":16}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e){return r.get("syncedinfo?prefix="+e)}function i(){return r.get("syncedinfo")}function s(e){if(e){return o(e)}else{return i()}}n.getSyncedValues=s;function a(e){if(!e){return $.Deferred().rejectWith(this,["Invalid key provided",500])}return r.get("syncedinfo",e,false)}n.getSyncedValue=a;function u(e,t){if(!e){return $.Deferred().rejectWith(this,["Invalid key provided",500])}return r.post("syncedinfo",[{key:e,value:t}])}n.putSyncedValue=u;function c(e){if(!e){return $.Deferred().rejectWith(this,["Invalid key provided",500])}return r.ddelete("syncedinfo",[e])}n.deleteSyncedKey=c},{"./internalMethods":16}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(){return r.get("system")}n.default=o},{"./internalMethods":16}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("./internalMethods");function o(e){return r.get("system","uploadurl?key="+e)}n.default=o},{"./internalMethods":16}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});function r(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}n.guid=r},{}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var r=e("../../package.json");function o(){return r.version}n.default=o},{"../../package.json":32}],31:[function(e,t,n){"use strict";var r=e("./commands/interactiveInfo");var o=e("./commands/systemInfo");var i=e("./commands/onlineStatus");var s=e("./commands/uploadUrl");var a=e("./commands/item");var u=e("./commands/collections");var c=e("./commands/folder");var l=e("./commands/filter");var d=e("./commands/gpsCoordinates");var f=e("./commands/search");var m=e("./commands/navigation");var v=e("./commands/downloader");var p=e("./commands/notification");var h=e("./commands/accountInfo");var g=e("./commands/localKeyValueStorage");var y=e("./commands/syncedKeyValueStorage");var w=e("./commands/applicationSync");var b=e("./commands/navigation");var M=e("./commands/appFeatures");var _=e("./commands/controls");var I=e("./commands/embed");var j=e("./commands/postAction");var S=e("./commands/postEvent");var O=e("./commands/device");var x=e("./commands/openWindow");var P=e("./commands/email");var C=e("./commands/credentials");var W=e("./commands/version");var D={close:m.close,getInteractiveInfo:r.default,getCredentials:C.default,getSystemInfo:o.default,getOnlineStatus:i.default,getGpsCoordinates:d.default,getUploadUrl:s.default,getFolder:c.default,filter:l.default,search:f.search,showSearch:f.showSearch,hideControlBars:_.hideControlBars,showControlBars:_.showControlBars,embed:I.embed,embedImage:I.embedImage,getData:I.getData,getDeviceType:O.getDeviceType,getPrefix:O.getPrefix,isLocalhostForDevelopment:O.isLocalhostForDevelopment,isWindows8:O.isWindows8,openWindow:x.default,postAction:j.postAction,postPageView:j.postPageView,postEvent:S.postEvent,getEmailStatus:P.getEmailStatus,sendEmail:P.sendEmail,version:W.default};$.extend(D,a);$.extend(D,u);$.extend(D,v);$.extend(D,p);$.extend(D,h);$.extend(D,g);$.extend(D,y);$.extend(D,w);$.extend(D,b);$.extend(D,M);t.exports=D},{"./commands/accountInfo":1,"./commands/appFeatures":2,"./commands/applicationSync":3,"./commands/collections":4,"./commands/controls":6,"./commands/credentials":7,"./commands/device":8,"./commands/downloader":9,"./commands/email":10,"./commands/embed":11,"./commands/filter":12,"./commands/folder":13,"./commands/gpsCoordinates":14,"./commands/interactiveInfo":15,"./commands/item":17,"./commands/localKeyValueStorage":18,"./commands/navigation":19,"./commands/notification":20,"./commands/onlineStatus":21,"./commands/openWindow":22,"./commands/postAction":23,"./commands/postEvent":24,"./commands/search":25,"./commands/syncedKeyValueStorage":26,"./commands/systemInfo":27,"./commands/uploadUrl":28,"./commands/version":30}],32:[function(e,t,n){t.exports={name:"mfly-commands",version:"2.0.2",description:"mflyCommands.js for Mediafly Interactives",main:"src/mflyCommands.min.js",scripts:{clean:"rm -rf .temp src & mkdir src",compile:"tsc",browserify:"browserify .temp/mflyCommands.js --standalone mflyCommands > src/mflyCommands.js",uglify:"uglifyjs --mangle -- src/mflyCommands.js > src/mflyCommands.min.js",prebuild:"npm run clean",build:"npm run compile && npm run browserify && npm run uglify",watch:"npm run build & chokidar mflyCommands.ts commands/**/*.ts -c 'npm run build' --polling --poll-interval 100 --verbose"},repository:{type:"git",url:"git+ssh://git@github.com/mediafly/mflyCommands.git"},author:{name:"Nachiket Mehta",email:"nmehta@mediafly.com",url:"https://github.com/mediafly"},license:"ISC",bugs:{url:"https://github.com/mediafly/mflyCommands/issues"},homepage:"https://github.com/mediafly/mflyCommands#readme",keywords:["mflyCommands","Mediafly","Interactives"],dependencies:{jquery:"^1.11.0"},devDependencies:{browserify:"13.1.0","browserify-shim":"3.8.12","chokidar-cli":"1.2.0",typescript:"2.0.3","uglify-js":"^3.0.7"}}},{}]},{},[31])(31)});
